From 052442d84041859a4760f12a2f161bebb20e963b Mon Sep 17 00:00:00 2001
From: David Dufresne <27902736+ddufresne@users.noreply.github.com>
Date: Tue, 9 Mar 2021 15:16:54 -0500
Subject: [PATCH 1/1] Enable a specific config file

---
 odoo/tools/config.py | 24 +++++++++++++++++++++++-
 1 file changed, 23 insertions(+), 1 deletion(-)

diff --git a/odoo/tools/config.py b/odoo/tools/config.py
index f6e186f15ab..ff7be5b8f2b 100644
--- a/odoo/tools/config.py
+++ b/odoo/tools/config.py
@@ -725,4 +725,26 @@ class configmanager(object):
         return realpath(abspath(expanduser(expandvars(path.strip()))))
 
 
-config = configmanager()
+class ConfigManagerWithSpecificConfigFile(configmanager):
+
+    def load(self):
+        """Load the config from a generic and a specific rc file.
+
+        The generic rc file is the standard Odoo rc file.
+        The specific rc file is given through the environment variable SPECIFIC_ODOO_RC.
+
+        The config is first loaded with the generic file, through the call to super.
+
+        If a specific rc file is given, the super method is called a second time
+        but with the rcfile variable pointing to the specific file.
+        """
+        super().load()
+        generic_rcfile = self.rcfile
+        specific_rcfile = os.environ.get('SPECIFIC_ODOO_RC')
+
+        if specific_rcfile:
+            self.rcfile = specific_rcfile
+            super().load()
+            self.rcfile = generic_rcfile
+
+config = ConfigManagerWithSpecificConfigFile()
-- 
2.17.1

